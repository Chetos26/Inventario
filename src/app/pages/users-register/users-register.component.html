<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-lg-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Formulario</h5>
          <form [formGroup]="usersForm">
            <div class="mb-3">
              <label for="foto" class="form-label">Foto</label>
              <input name="foto" type="file" class="form-control" id="foto" formControlName="foto" [(ngModel)]="usersUpdate.foto">
            </div>
            <div class="mb-3">
              <label for="cargo" class="form-label">Cargo</label>
              <input name="cargo" type="text" class="form-control" id="cargo" formControlName="cargo" [(ngModel)]="usersUpdate.cargo">
              <div *ngIf="usersForm.get('cargo')?.hasError('required') && usersForm.get('cargo')?.touched" class="error-message">
                Cargo es requerido.
              </div>
            </div>
            <div class="mb-3">
              <label for="nombre" class="form-label">Nombre</label>
              <input name="nombre" type="text" class="form-control"
              id="nombre" formControlName="nombre_u" maxlength="15" [(ngModel)]="usersUpdate.nombre_u">
              <div *ngIf="usersForm.get('nombre_u')?.hasError('required') && usersForm.get('nombre_u')?.touched" class="error-message">
                Nombre es requerido.
              </div>
              <div *ngIf="usersForm.get('nombre_u')?.dirty && usersForm.get('nombre_u')?.hasError('pattern')" class="error-message">
                Solo se admiten letras.
              </div>
            </div>
            <div class="mb-3">
              <label for="apellido" class="form-label">Apellido</label>
              <input name="apellido" type="text" class="form-control"
              id="apellido" formControlName="apellido_u" maxlength="15" [(ngModel)]="usersUpdate.apellido_u">
              <div *ngIf="usersForm.get('apellido_u')?.hasError('required') && usersForm.get('apellido_u')?.touched" class="error-message">
                Apellido es requerido.
              </div>
              <div *ngIf="usersForm.get('apellido_u')?.dirty && usersForm.get('apellido_u')?.hasError('pattern')" class="error-message">
                Solo se admiten letras.
              </div>
            </div>
            <div class="mb-3">
              <label for="telf" class="form-label">Teléfono</label>
              <input maxlength="10" name="tel" type="text" class="form-control"
              id="telf" formControlName="telf" [(ngModel)]="usersUpdate.telf">
              <div *ngIf="usersForm.get('telf')?.hasError('required') && usersForm.get('telf')?.touched" class="error-message">
                Teléfono es requerido.
              </div>
              <div *ngIf="usersForm.get('telf')?.dirty && usersForm.get('telf')?.hasError('minlength')" class="error-message">
                El teléfono debe contener 10 dígitos.
              </div>
              <div *ngIf="usersForm.get('telf')?.dirty && usersForm.get('telf')?.hasError('maxlength')" class="error-message">
                El teléfono debe contener 10 dígitos.
              </div>
              <div *ngIf="usersForm.get('telf')?.dirty && usersForm.get('telf')?.hasError('pattern')" class="error-message">
                El teléfono debe contener solo números.
              </div>
            </div>
            <div class="mb-3">
              <label for="email" class="form-label">Correo electrónico</label>
              <input name="email" type="text" class="form-control email"
              [maxLength]="30" id="email" formControlName="email" [(ngModel)]="usersUpdate.email">
              <div *ngIf="usersForm.get('email')?.hasError('required') && usersForm.get('email')?.touched" class="error-message">
                Correo electrónico es requerido.
              </div>
              <div *ngIf="usersForm.get('email')?.hasError('pattern') && usersForm.get('email')?.touched" class="error-message">
                Por favor, ingresa un correo electrónico válido.
              </div>
            </div>
            <div class="btn-group d-flex">
              <button class="btn btn-primary me-2" type="button" *ngIf="!bool" (click)="registerUsers()">Registrar </button>
              <button class="btn btn-primary me-2" type="button" *ngIf="bool" (click)="update(usersUpdate)">Actualizar</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="mb-4"></div>

  <!-- Modal de Validación -->
  <div class="modal" tabindex="-1" role="dialog" [class.show]="showModal" (click)="closeModal()">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">El formulario no es Válido</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="closeModal()">
          </button>
        </div>
        <div class="modal-body">
          Por favor, completa correctamente el formulario antes de continuar.
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="closeModal()">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Registro Exitoso -->
  <div class="modal" tabindex="-1" role="dialog" [class.show]="showRegisterModal" (click)="closeRegisterModal()">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Registro Exitoso</h5>
          <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close" (click)="closeRegisterModal()">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          ¡El usuario se ha registrado exitosamente!
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="closeRegisterModal()">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

    <!-- Modal de Actualización Exitosa -->
    <div class="modal" tabindex="-1" role="dialog" [class.show]="showUpdateModal" (click)="closeUpdateModal()">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Actualización Exitosa</h5>
            <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close" (click)="closeUpdateModal()">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            ¡El usuario se ha actualizado exitosamente!
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" (click)="closeUpdateModal()">Cerrar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de Error -->
<div class="modal" tabindex="-1" role="dialog" [class.show]="showErrorModal" (click)="closeErrorModal()">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Error</h5>
        <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close" (click)="closeErrorModal()">
        </button>
      </div>
      <div class="modal-body">
        {{ errorMessage }}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="closeErrorModal()">Cerrar</button>
      </div>
    </div>
  </div>
</div>
